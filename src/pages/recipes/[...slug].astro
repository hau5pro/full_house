---
import { getCollection, render } from "astro:content";
import { CDN_BASE } from "../../config";
import BaseLayout from "../../layouts/base-layout.astro";
import "../../styles/recipe.css"; // Import your new separate CSS file

export async function getStaticPaths() {
  const posts = await getCollection("recipes");
  return posts.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const imageUrl = `${CDN_BASE}/${entry.data.image}`;
const { Content } = await render(entry);

const category = entry.id.includes("/")
  ? entry.id.split("/")[0]
  : "Uncategorized";
---

<BaseLayout title={`${entry.data.title} | Full House`}>
  <div class="container-narrow">
    <header class="recipe-header">
      <span class="cat-tag">{category}</span>
      <h1>{entry.data.title}</h1>
      <div class="recipe-meta">
        {
          entry.data.prepTime && (
            <div class="recipe-meta-item">
              <span class="meta-label">Prep Time</span>
              <span class="meta-value">{entry.data.prepTime}</span>
            </div>
          )
        }
        {
          entry.data.cookTime && (
            <div class="recipe-meta-item">
              <span class="meta-label">Cook Time</span>
              <span class="meta-value">{entry.data.cookTime}</span>
            </div>
          )
        }
      </div>
      {
        entry.data.image && (
          <img src={imageUrl} alt={entry.data.title} class="recipe-img" />
        )
      }
    </header>

    <article class="prose">
      <Content />
    </article>
  </div>
</BaseLayout>
